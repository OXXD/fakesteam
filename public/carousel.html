<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/index.css">
</head>

<body>
    <div class="main">
        <div class="home_cluster">
            <div class="carousel_container">
                <div class="carousel_items_container">
                    <div class="carousel_items">
                        <a href="app.html?appid=578080" class="store_capsule">
                            <img src="img/index/capsule_616x353.jpg" data-src="img/index/capsule_616x353.jpg" class="main_capsule">
                            </img>
                            <div class="info">
                                <div class="app_name">PLAYERUNKNOWN'S BATTLEGROUNDS</div>
                                <div class="screenshots clear">
                                    <img src="img/index/ss_4f97f2957cc4808652fe8993a4fa85e89114427d.600x338.jpg" alt="">
                                    <img src="img/index/ss_15f25d045c3be1f158520a2b32aba5f1b6fbb836.600x338.jpg" alt="">
                                    <img src="img/index/ss_47c8740e26273a8f89a7c515205824fcac0b6846.600x338.jpg" alt="">
                                    <img src="img/index/ss_3477d04431bbcef047c1025510bb6ad794acb2d2.600x338.jpg" alt="">
                                </div>
                                <div class="reson">
                                    <div class="main">现已推出</div>
                                    <div class="additional">热销商品</div>
                                </div>
                                <div class="discount_block sm">
                                    <div class="finalprice">¥ 98</div>
                                </div>
                                <div class="platforms">
                                    <span class="platform_img win"></span>
                                    <span class="platform_img mac"></span>
                                    <span class="platform_img linux"></span>
                                </div>
                            </div>
                        </a>
                        <!-- a carousel_item end -->
                        <a href="app.html?appid=365590" class="store_capsule">
                            <img src="img/index/capsule_616x353_1.jpg" data-src="img/index/capsule_616x353_1.jpg" class="main_capsule">
                            </img>
                            <div class="info">
                                <!-- <div class="app_name">Assassin's Creed® Origins</div> -->
                                <div class="app_name">Tom Clancy's The Division™</div>
                                <div class="screenshots clear">
                                    <img src="img/index/ss_a0f8165b42cffb60d5ac4f7a2f8878b94de1462e.600x338.jpg" alt="">
                                    <img src="img/index/ss_a2b95a416686d783a84a9f230f7a20673d84d57d.600x338.jpg" alt="">
                                    <img src="img/index/ss_ad93d281d80d8539a850ef456cf2685a358a0c17.600x338.jpg" alt="">
                                    <img src="img/index/ss_ccaff05381f32abfea80aa8a54b6d1e4be1f588f.600x338.jpg" alt="">
                                </div>
                                <div class="reson">
                                    <div class="main">现已推出</div>
                                    <div class="additional">热销商品</div>
                                </div>
                                <div class="discount_block sm">
                                    <div class="discount_pct">-50%</div>
                                    <div class="discount_price">
                                        <div class="orginalprice">¥ 36</div>
                                        <div class="discountprice">¥ 18</div>
                                    </div>
                                </div>
                                <div class="platforms">
                                    <span class="platform_img win"></span>
                                </div>
                            </div>
                        </a>
                        <!-- a carousel_item end -->
                        <a href="app.html?appid=582160" class="store_capsule">
                            <img src="img/index/capsule_616x353_schinese.jpg" data-src="img/index/capsule_616x353_schinese.jpg" class="main_capsule">
                            </img>
                            <div class="info">
                                <!-- <div class="app_name">Assassin's Creed® Origins</div> -->
                                <div class="app_name">Assassin's Creed® Origins</div>
                                <div class="screenshots clear">
                                    <img src="img/index/ss_1a0ab42e93e51c48ad9a6bda7f408958e09a43b0.600x338.jpg" alt="">
                                    <img src="img/index/ss_c4a4545f51c6836ac11c31427944fc7df813edfb.600x338.jpg" alt="">
                                    <img src="img/index/ss_fbed28aec9059db9477e9bf8fb2ffa92c3ea9e56.600x338.jpg" alt="">
                                    <img src="img/index/ss_7edc3de6db0e6391158863f766c334c6eab1dbaa.600x338.jpg" alt="">
                                </div>
                                <div class="reson">
                                    <div class="main">现已推出</div>
                                    <div class="additional">热销商品</div>
                                </div>
                                <div class="discount_block sm">
                                    <div class="finalprice">¥ 98</div>
                                </div>
                                <div class="platforms">
                                    <span class="platform_img win"></span>
                                </div>
                            </div>
                        </a>
                        <!-- a carousel_item end -->
                        <a href="app.html?appid=240720" class="store_capsule">
                            <img src="img/index/capsule_616x353_(4).jpg" data-src="img/index/capsule_616x353_(4).jpg" class="main_capsule">
                            </img>
                            <div class="info">
                                <!-- <div class="app_name">Assassin's Creed® Origins</div> -->
                                <div class="app_name">Getting Over It with Bennett Foddy</div>
                                <div class="screenshots clear">
                                    <img src="img/index/ss_413828bfd197dae1e356f6b43c4c38a9d3466591.600x338.jpg" alt="">
                                    <img src="img/index/ss_b0efcf546b861e6fbb6f6a703c2374536af761f5.600x338.jpg" alt="">
                                    <img src="img/index/ss_ba1b345f67daf713bd94934e0d837eb7f3625e4e.600x338.jpg" alt="">
                                    <img src="img/index/ss_7b0cb6b5294d7deffa3afafe6d00aa8e5c958e47.600x338.jpg" alt="">
                                </div>
                                <div class="reson">
                                    <div class="main">现已推出</div>
                                    <div class="additional">热销商品</div>
                                </div>
                                <div class="discount_block sm">
                                    <div class="discount_pct">-50%</div>
                                    <div class="discount_price">
                                        <div class="orginalprice">¥ 36</div>
                                        <div class="discountprice">¥ 18</div>
                                    </div>
                                </div>
                                <div class="platforms">
                                    <span class="platform_img win"></span>
                                </div>
                            </div>
                        </a>
                        <!-- a carousel_item end -->
                        <a href="app.html?appid=578080" class="store_capsule">
                            <img src="img/index/capsule_616x353.jpg" data-src="img/index/capsule_616x353.jpg" class="main_capsule">
                            </img>
                            <div class="info">
                                <div class="app_name">PLAYERUNKNOWN'S BATTLEGROUNDS</div>
                                <div class="screenshots clear">
                                    <img src="img/index/ss_4f97f2957cc4808652fe8993a4fa85e89114427d.600x338.jpg" alt="">
                                    <img src="img/index/ss_15f25d045c3be1f158520a2b32aba5f1b6fbb836.600x338.jpg" alt="">
                                    <img src="img/index/ss_47c8740e26273a8f89a7c515205824fcac0b6846.600x338.jpg" alt="">
                                    <img src="img/index/ss_3477d04431bbcef047c1025510bb6ad794acb2d2.600x338.jpg" alt="">
                                </div>
                                <div class="reson">
                                    <div class="main">现已推出</div>
                                    <div class="additional">热销商品</div>
                                </div>
                                <div class="discount_block sm">
                                    <div class="finalprice">¥ 98</div>
                                </div>
                                <div class="platforms">
                                    <span class="platform_img win"></span>
                                    <span class="platform_img mac"></span>
                                    <span class="platform_img linux"></span>
                                </div>
                            </div>
                        </a>
                        <!-- a carousel_item end -->
                    </div>
                </div>
                <div class="carousel_thumbs">
                    <!-- <div class="focus"></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div> -->
                </div>
                <div class="arrow left">
                    <div></div>
                </div>
                <div class="arrow right">
                    <div></div>
                </div>
            </div>
        </div>
    </div>


    <script src="js/jquery-3.2.0.js"></script>
    <script>
        // carousel 轮播
        $(() => {
            // 获取和修改数据, DOM
            const WIDTH = 960;
            var $carouselItems = $(".home_cluster .carousel_items");
            // var data = $carouselItems.children();
            var data = {
                length: $carouselItems.children().length - 1
            };
            // console.log(data, data.length);
            var $carouselThumbs = $(".home_cluster .carousel_thumbs");
            $carouselThumbs.html("<div></div>".repeat(data.length)).children().first().addClass("focus");
            $carouselItems.css("width", WIDTH * (data.length + 1)); // data.length+1

            // 定义移动需要用的变量
            const WAIT = 3000,
                DURA = 1000;
            var moved = 0,
                timer = null;

            // 定义移动方法
            function move(dir = 1) {
                moved += dir;
                console.log(moved);
                // if (moved > data.length) moved = 0;
                $carouselItems.animate({
                    left: -WIDTH * moved
                }, DURA, () => {
                    if (moved >= data.length) { // data.length
                        $carouselItems.css("left", 0);
                        moved = 0;
                    }
                    $carouselThumbs.children(`:eq(${moved})`).addClass("focus").siblings().removeClass("focus");
                });
            }

            // 启动定时器
            timer = setInterval(move, WAIT);

            // 鼠标移入时暂停动画，左右按钮事件绑定
            $(".home_cluster").hover(
                () => {
                    clearInterval(timer);
                    timer = null;
                },
                () => {
                    timer = setInterval(move, WAIT);
                }
            );
            $(".home_cluster .arrow.right").click(() => {
                if (!$carouselItems.is(":animated")) move();
            });
            $(".home_cluster .arrow.left").click(() => {
                if (!$carouselItems.is(":animated")) {
                    if (moved == 0) {
                        $carouselItems.css("left", -WIDTH * (data.length));
                        moved = data.length;
                    }
                    move(-1);
                }
            });

            // 下方小点事件绑定
            $carouselThumbs.on("click", "div", function() {
                var $thumbs = $(this);
                var i = $thumbs.index();
                moved = i;
                $carouselItems.stop(true).animate({
                    left: -WIDTH * moved
                }, DURA, () => {
                    $carouselThumbs.children(`:eq(${i})`).addClass("focus").siblings().removeClass("focus");
                });
            });

        });
    </script>
</body>

</html>